#include "cszm_modules/newspawn"
#include "cszm_modules/cashmaker"

array<array<CSpawnPoint@>> SL_HumanSpawns = 
{
	{
		CSpawnPoint(Vector(-2152, 1536, 1033), QAngle(0, 90, 0)),
		CSpawnPoint(Vector(-2120, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-1896, 1536, 1033), QAngle(0, 90, 0)),
		CSpawnPoint(Vector(-2376, 1856, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-1960, 1600, 1033), QAngle(0, 90, 0)),
		CSpawnPoint(Vector(-1864, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2248, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2056, 1920, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2216, 1600, 1033), QAngle(0, 90, 0)),
		CSpawnPoint(Vector(-2376, 1920, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2440, 1856, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2152, 1600, 1033), QAngle(0, 90, 0)),
		CSpawnPoint(Vector(-1992, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2184, 1920, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2312, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2440, 1920, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-1928, 1920, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2376, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2248, 1856, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2024, 1600, 1033), QAngle(0, 90, 0)),
		CSpawnPoint(Vector(-1928, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-2248, 1920, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-1800, 1984, 1033), QAngle(0, -90, 0)),
		CSpawnPoint(Vector(-1960, 1536, 1033), QAngle(0, 90, 0))
	},
	{
		CSpawnPoint(Vector(-3269.53, 2554.27, 888.031), QAngle(0.907463, -25.1319, 0)),
		CSpawnPoint(Vector(-2844.23, 2538.62, 889.262), QAngle(4.24705, -158.099, 0)),
		CSpawnPoint(Vector(-2797.08, 1869.34, 888.031), QAngle(5.19086, -51.5948, 0)),
		CSpawnPoint(Vector(-3318.07, 1920.92, 775.279), QAngle(3.15803, -112.01, 0)),
		CSpawnPoint(Vector(-3679.51, 1605.03, 780.031), QAngle(0.0362612, -15.0542, 0)),
		CSpawnPoint(Vector(-3140.97, 1603.94, 780.031), QAngle(6.42507, -152.413, 0)),
		CSpawnPoint(Vector(-2594.15, 1528.83, 720.031), QAngle(1.41582, -30.7962, 0)),
		CSpawnPoint(Vector(-1837.75, 1561.16, 800.031), QAngle(18.0412, -150.853, 0)),
		CSpawnPoint(Vector(-1987.87, 2016.42, 848.031), QAngle(2.83149, 173.682, 0)),
		CSpawnPoint(Vector(-1409.11, 1631.37, 903.782), QAngle(10.5633, 88.7401, 0)),
		CSpawnPoint(Vector(-1326.75, 2159.31, 888.031), QAngle(1.52465, 27.4294, 0)),
		CSpawnPoint(Vector(-1150.39, 2876.44, 888.031), QAngle(2.72254, -78.8698, 0)),
		CSpawnPoint(Vector(-1392.44, 2189.57, 1016.03), QAngle(20.2554, 12.1711, 0)),
		CSpawnPoint(Vector(-1914.75, 1575.08, 1032.03), QAngle(3.84779, 128.742, 0)),
		CSpawnPoint(Vector(-2006.56, 1778.97, 1043.03), QAngle(18.15, -138.003, 0)),
		CSpawnPoint(Vector(-2252.96, 1898.61, 1032.03), QAngle(3.88407, -55.2755, 0)),
		CSpawnPoint(Vector(-2474.91, 1548.73, 1032.03), QAngle(-1.01645, 34.3134, 0)),
		CSpawnPoint(Vector(-2504.77, 2158.64, 1032.03), QAngle(3.01286, -46.2726, 0)),
		CSpawnPoint(Vector(-1607.01, 2161.93, 1032.03), QAngle(3.08546, -136.986, 0)),
		CSpawnPoint(Vector(-1949.8, 2269.29, 824.031), QAngle(4.02938, 134.211, 0)),
		CSpawnPoint(Vector(-2663.79, 3285.82, 888.031), QAngle(4.46499, -133.768, 0)),
		CSpawnPoint(Vector(-1710.36, 3155.55, 1056.03), QAngle(24.8656, -136.889, 0)),
		CSpawnPoint(Vector(-1493.23, 3386.74, 1016.03), QAngle(7.18752, -81.4467, 0))
	},
	{
		CSpawnPoint(Vector(-1380.99, 2800.77, 888.031), QAngle(5.08213, 64.6608, 0)),
		CSpawnPoint(Vector(-1249.97, 2720, 895.059), QAngle(0.943884, 3.0235, 0)),
		CSpawnPoint(Vector(-834.367, 2251.24, 888.031), QAngle(6.20735, 158.823, 0)),
		CSpawnPoint(Vector(-1383.19, 1866.15, 888.031), QAngle(12.2331, -118.993, 0)),
		CSpawnPoint(Vector(-2455.68, 2067.97, 848.031), QAngle(-1.27044, -130.282, 0)),
		CSpawnPoint(Vector(-1937.78, 1294.71, 808.031), QAngle(16.8433, 136.716, 0)),
		CSpawnPoint(Vector(-2591.71, 1288.42, 812.031), QAngle(-9.07495, 109.019, 0)),
		CSpawnPoint(Vector(-3114.75, 1867.24, 888.031), QAngle(3.33962, 64.5517, 0)),
		CSpawnPoint(Vector(-3341.89, 1536.47, 781.219), QAngle(-13.5036, 113.63, 0)),
		CSpawnPoint(Vector(-3272.19, 2199.49, 888.031), QAngle(7.91345, 17.9072, 0)),
		CSpawnPoint(Vector(-2754.39, 2727.72, 888.031), QAngle(14.5564, -146.858, 0)),
		CSpawnPoint(Vector(-3054.38, 3506.6, 888.031), QAngle(4.21092, -117.092, 0)),
		CSpawnPoint(Vector(-2655.24, 2995.56, 888.031), QAngle(7.65944, 143.179, 0)),
		CSpawnPoint(Vector(-2397.38, 3085.68, 888.031), QAngle(4.57399, -38.2488, 0)),
		CSpawnPoint(Vector(-2241.85, 2628.03, 824.031), QAngle(0.689866, 14.8582, 0)),
		CSpawnPoint(Vector(-1739.31, 3099.74, 888.031), QAngle(10.1642, -139.49, 0)),
		CSpawnPoint(Vector(-2099.14, 2125.67, 1032.03), QAngle(14.5201, -49.8407, 0)),
		CSpawnPoint(Vector(-1612.06, 1470.67, 1030.03), QAngle(1.37947, 146.761, 0)),
		CSpawnPoint(Vector(-1474.89, 2019.41, 1016.03), QAngle(3.12188, 71.9827, 0)),
		CSpawnPoint(Vector(-1916.76, 2106.32, 1164.03), QAngle(21.4897, -114.527, 0)),
		CSpawnPoint(Vector(-1662.54, 1836.53, 1142.79), QAngle(18.0048, -166.182, 0)),
		CSpawnPoint(Vector(-1762.92, 1463.9, 1146.03), QAngle(12.9955, 102.124, 0)),
		CSpawnPoint(Vector(-2313.27, 1457.64, 1032.03), QAngle(-0.217701, 49.6707, 0)),
		CSpawnPoint(Vector(-2668.05, 1520.52, 1032.62), QAngle(6.49781, 144.51, 0))
	}
};

void OnMapInit()
{
	iMaxCash = 8;
	iMinCash = 4;

	g_Origins.insertLast(Vector(-1558.54, 2029.38, 951.016));
	g_Origins.insertLast(Vector(-2339.93, 1094.39, 585.031));
	g_Origins.insertLast(Vector(-2340.81, 1604.4, 801.031));
	g_Origins.insertLast(Vector(-3656.48, 1667.89, 858.031));
	g_Origins.insertLast(Vector(-3112.07, 1503.72, 877.979));
	g_Origins.insertLast(Vector(-3231.59, 2187.62, 1119.29));
	g_Origins.insertLast(Vector(-3011.24, 3403.88, 925.031));
	g_Origins.insertLast(Vector(-2735.81, 2745.02, 889.031));
	g_Origins.insertLast(Vector(-2673.71, 3150.15, 912.031));
	g_Origins.insertLast(Vector(-1831.65, 3232.5, 1142.86));
	g_Origins.insertLast(Vector(-2065.09, 2265.87, 929.031));
	g_Origins.insertLast(Vector(-2037.45, 2484.9, 1121.03));
	g_Origins.insertLast(Vector(-2457.99, 1459.38, 1141.03));
	g_Origins.insertLast(Vector(-1807.19, 1493.12, 1261.03));
	g_Origins.insertLast(Vector(-1595.84, 2127.81, 1033.03));
	g_Origins.insertLast(Vector(-2429.9, 1419.61, 1065.03));
	g_Origins.insertLast(Vector(-826.005, 2118.5, 993.031));
	g_Origins.insertLast(Vector(-831.771, 2132.34, 993.031));
	g_Origins.insertLast(Vector(-1434.88, 3348.66, 1156.92));
	g_Origins.insertLast(Vector(-2417.47, 2938.16, 978.031));
	g_Origins.insertLast(Vector(-1727.91, 2732.16, 977.031));
	g_Origins.insertLast(Vector(-1816.53, 1435.91, 1261.03));
	g_Origins.insertLast(Vector(-1598.65, 2092.52, 1069.03));
	g_Origins.insertLast(Vector(-2748.19, 1583.44, 1105.03));
	g_Origins.insertLast(Vector(-2740.27, 1539.08, 1041.03));
	g_Origins.insertLast(Vector(-2902.64, 2674.69, 993.031));
	g_Origins.insertLast(Vector(-2843.02, 1925.71, 966.031));
	g_Origins.insertLast(Vector(-2840.93, 2953.43, 982.031));
	g_Origins.insertLast(Vector(-3361.3, 1543.73, 1039.29));
	g_Origins.insertLast(Vector(-1321.97, 2765.89, 1103.04));
	g_Origins.insertLast(Vector(-2007.39, 2081.14, 1069.03));
	g_Origins.insertLast(Vector(-1901.63, 2202.46, 1033.03));
	g_Origins.insertLast(Vector(-2118.82, 2194.15, 1124.03));
	g_Origins.insertLast(Vector(-2417.31, 1487.69, 1141.03));
	g_Origins.insertLast(Vector(-1830.02, 1413.11, 1033.03));

	Schedule::Task(0.05f, "SetUpStuff");
}

void OnNewRound()
{
	Schedule::Task(0.05f, "SetUpStuff");
}

void SetUpStuff()
{
	int iRNDPitch = Math::RandomInt(65, 135);
	
	Engine.Ent_Fire("teleport_ambient", "Pitch", formatInt(iRNDPitch));
	Engine.Ent_Fire("teleport_ambient", "AddOutput", "pitchstart " + formatInt(iRNDPitch));
	Engine.Ent_Fire("teleport_ambient", "AddOutput", "pitch " + formatInt(iRNDPitch));
	
	Engine.Ent_Fire("teleport_ambient", "PlaySound");
	Engine.Ent_Fire("teleport_ambient", "Volume", "10");
	
	Engine.Ent_Fire("shading", "StartOverlays");
	
	CreatedByColors();

	RemoveNativeSpawns("info_player_zombie");
	RemoveNativeSpawns("info_player_human");
	CreateSpawnsFromArray(SL_HumanSpawns, true);
}

void CreatedByColors()
{
	float flFireTime = Math::RandomFloat(0.10f, 1.20f);
	
	Schedule::Task(flFireTime, "CreatedByColors");
	
	int iR = Math::RandomInt(32, 255);
	int iG = Math::RandomInt(32, 255);
	int iB = Math::RandomInt(32, 255);
	
	Engine.Ent_Fire("created_by", "color", ""+formatInt(iR)+" "+formatInt(iG)+" "+formatInt(iB));
}